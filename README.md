# Comeet_BE
[프로그래머스 풀스택 데브코스 7기] 게살버거팀 사이드 프로젝트_위치기반 개발자 커뮤니티 

# 트러블 슈팅 경험

## 새로 빌드할 수록 서버 성능 저하

## 문제상황
코드를 새로 배포할 수록, 빌드시간이 증가하여 종국에는 이미지 빌드에 23분이나 걸리게 됨 \
또한 api 응답에 걸리는 시간도 10배 이상 증가함

### 관찰 1
image를 새로 빌드할 때마다, CPU & Network 사용량이 급격하게 증가하는 것을 발견

### 해결 1 
github action을 이용하여 별도 서버에서 이미지를 빌드하여, docker hub에 올리고 \
프로덕션 서버에서 빌드된 이미지를 pull 해서 쓰는 것으로 변경
-> 빌드시간 3분 이내로 안정화됨, 그러나 api 성능 저하는 해결하지 못함

### 관찰2

``` shell
docker stats
```
명령어를 통해 container의 자원 사용량을 발견
-> 순간 Net/IO, Block/IO 항목이 할당량 보다 많은 자원을 소비하는 것을 알게 됨

### 해결2
t2 micro 크래딧의 한계로 인한 성능저하로 판단하여, unlimited 모드로 설정함 \
unlimited 모드: 자원 사용량이 limit을 초고할 경우 credit을 초과분 만큼 늘리고 후에 초과 사용량 만큼의 금액을 청구하는 방식 \
응답시간 다시 이전과 같은 수준으로 감소함

### 결론
docker를 통해 안정적인 배포를 하려면 t2 micro 보다 높은 사양 서버가 필요 \
규모가 작은 프로젝트라먄 도커를 사용하지 않고 t2 micro에 배포하는 것도 합리적이어 보임


